import{$ as t}from"./all-f07a255b.js";import{l as f}from"./L.Control.Locate-170a7ece.js";const ee="modulepreload",te=function(m,A){return new URL(m,A).href},W={},oe=function(A,E,V){if(!E||E.length===0)return A();const g=document.getElementsByTagName("link");return Promise.all(E.map(c=>{if(c=te(c,V),c in W)return;W[c]=!0;const u=c.endsWith(".css"),h=u?'[rel="stylesheet"]':"";if(!!V)for(let I=g.length-1;I>=0;I--){const l=g[I];if(l.href===c&&(!u||l.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${c}"]${h}`))return;const r=document.createElement("link");if(r.rel=u?"stylesheet":ee,u||(r.as="script",r.crossOrigin=""),r.href=c,document.head.appendChild(r),u)return new Promise((I,l)=>{r.addEventListener("load",I),r.addEventListener("error",()=>l(new Error(`Unable to preload CSS for ${c}`)))})})).then(()=>A())};function ae(m={}){const{immediate:A=!1,onNeedRefresh:E,onOfflineReady:V,onRegistered:g,onRegisteredSW:c,onRegisterError:u}=m;let h,b;const r=async(l=!0)=>{await b};async function I(){if("serviceWorker"in navigator){const{Workbox:l}=await oe(()=>import("./workbox-window.prod.es5-295a6886.js"),[],import.meta.url);h=new l("./sw.js",{scope:"./",type:"classic"}),h.addEventListener("activated",p=>{(p.isUpdate||p.isExternal)&&window.location.reload()}),h.addEventListener("installed",p=>{p.isUpdate||V==null||V()}),h.register({immediate:A}).then(p=>{c?c("./sw.js",p):g==null||g(p)}).catch(p=>{u==null||u(p)})}}return b=I(),r}const re="data:image/png;base64,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fFvbqMe3V6lP/wULofNwWi7YuXZNUKHIK+SF9MbyisOeTl3Zv650wP19vG8vMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMVgIMURvF5dXHJZgMs7+daU97j+XEGKwEGKwEGKwEGKwEGKwEGKwEGKwEGKwEGL8H6PEFvcfQRp6AAAAAElFTkSuQmCC",ne=""+new URL("BusIcon-8a605cbb.png",import.meta.url).href,T="https://backend.matiasrolando.com";var G={10:["2","D222","222","402","404","405","407","409","427","456","494","4A","4AC","4AD","4D","48D","4DR","5D","600","76","CE1","D9","G","L14","L16","L29","L7"],13:["15A","15B","6A","6R6"],18:["1A","2A","700","701","702","702R","703","704","705","706","707","708","709","710","711","712","714","724","747","748","750","751","752","757","7A","7E7R","7E8R","7E8D","7H","802","803","804","805","806","807","808","809","888","8A","8E7R","8E8R","DM1","P757","P758","P759","P760","P761","P768","P7H","XA1","XA2"],20:["1M11","1M1","1M2","1M3","1M4","1M5","1M6","1M7","1M12","1M13","1M14","1M15","1M16","1M6","1M7","2M1","2M7","2M8","505","522","524","526","538","546","582","D11","L24","L25","L38","MD3","ML1"],29:["2K"],32:["S5","S6","S7"],33:["A1","A10","A11","A12","A14","A16","A18","A5","A6","A9"],35:["10A","14A","14AB","14AR","T1","T14A","T2","T4N","T4R","T5","T6"],36:[],37:[],39:["Z1","Z2","Z3","Z4"],50:["100","102","103","104","105","109","110","111","112","113","115","116","117","121","124","125","127","128","130","137","141","142","143","144","145","147","148","149","150","151","155","156","157","158","163","169","174","175","180","181","183","185","186","187","188","191","192","195","199","21","214","227","230","230D","268","276","60","62","64","C1","C2","C3","C4","C5","CE1","D10","D5","D8","DE1","DM1","E14","G10","G11","G3","G8","L1","L15","L2","L20","L22","L26","L28","L3","L35","L36","L39","L4","L41","L46","L5","L6","L9"],70:["6B","11A","17","221","300","306","316","328","329","330","370","396","71","79","CE1","DM1","L12","L31","L33","U11C","XA1"],80:[]},w=null,v=null,B=null,ie=new Array,U=null,L=!0;let D=null;var k=null,S=null;let O=[];ae({immediate:!0});t(document).ready(function(){var m=null;window.addEventListener("beforeinstallprompt",A,E);function A(e){m=e,document.getElementById("pwa_btn").removeAttribute("disabled")}function E(e){console.log("error: "+e)}t("#pwa_btn").click(()=>{m&&m.prompt()}),setTimeout(()=>{m||(document.getElementById("pwa_btn").removeAttribute("disabled"),t("#pwa_btn").attr("data-bs-toggle","modal"),t("#pwa_btn").attr("data-bs-target","#exampleModal"))},1e3),window.mapita=f.map("map").setView([-34.814733,-56.180452],9).on("moveend",e=>{Q()}),f.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}).addTo(window.mapita),f.control.locate({position:"topright",strings:{title:"Ubicarme."}}).addTo(window.mapita),v=f.featureGroup().addTo(window.mapita);function V(){t.ajax({url:`${T}/updateDB`,method:"get",contentType:"application/json",success:function(e){console.log(e)}})}V();const g=100,c=e=>Math.ceil(e*g)/g,u=e=>Math.floor(e*g)/g,h=(e,o)=>{const a=u(e),d=c(o),i=[];for(let M=a;M<=d;M+=1/g)i.push(M);return i};let b=0,r=new Map;const I=window.localStorage.getItem("tileMap2");let l=null;I===null?l=new Map:l=new Map(JSON.parse(I));const p=e=>{b+=1;let o=b;const a=h(e._southWest.lat,e._northEast.lat),d=h(e._southWest.lng,e._northEast.lng);let i=new Array;for(const s of a)for(const n of d)i.push({lat:s,long:n});r.size>0&&r.forEach((s,n)=>{if(!i.some(y=>JSON.stringify(y)===n)){//!arrayTilesSeen.some(obj => JSON.stringify(obj) === JSON.stringify(key))
x(s),r.delete(n)}});let M=new Array;i.forEach(s=>{if(!r.has(JSON.stringify(s))){let n=N(s).then(y=>{if(o!=b)throw"se resolvió tarde";if(Array.isArray(y)){let K=X(y);return r.set(JSON.stringify(s),K),{tile:s,data:y}}else return r.set(JSON.stringify(s),[]),{tile:s,data:[]}});M.push(n)}}),Promise.allSettled(M).then(s=>{s.forEach(n=>{n.status=="fulfilled"&&l.set(JSON.stringify(n.value.tile),n.value.data)}),localStorage.setItem("tileMap2",JSON.stringify(Array.from(l.entries())))})},X=e=>{if(Array.isArray(e))return B=f.layerGroup(),e.forEach(o=>{const a=f.marker(o.geometry.coordinates,{icon:J});var d=t("<div>",{class:"overflow-auto",style:"max-height: 15rem; max-width: 10rem"});d.append('<p class="mb-0 mt-0 fs-6 fw-bold">Seleccioná la linea a buscar:  </p> </br> ');var i=t("<div>");o.properties.lineas.split("-").forEach(M=>{var s=t("<button>",{id:"button"+M,type:"button",class:"btn btn-outline-primary btn-sm",style:"width:4rem"}).on("click",n=>{F(n)}).append(M);i.append(s)}),d.append(i),a.bindPopup(d[0]),a.addTo(B)}),B.addTo(window.mapita),B._leaflet_id},F=e=>{L=!0;let o=null;for(let a in G)G[a].indexOf(e.currentTarget.innerText)!==-1&&(o=a);C(o,e.currentTarget.innerText),console.log(o),t("#empresa").val(o),t(".segundo").removeAttr("disabled"),t("#linea").empty(),t("#linea").append("<option value="+e.currentTarget.innerText+">"+e.currentTarget.innerText+"</option>")},N=async e=>{if(l.has(JSON.stringify(e))){let o=l.get(JSON.stringify(e));return new Promise(a=>{a(o)})}else{let o=[e.long+1/g,e.lat],a=[e.long,e.lat+1/g],d=String(o).replace(/\[|\]/g,""),i=String(a).replace(/\[|\]/g,"");return new Promise(M=>{t.ajax({url:`${T}/getStops?btmLeft=`+d+"&upperRight="+i,method:"get",contentType:"application/json",success:s=>{var n=s.data;Array.isArray(n)&&n.forEach(y=>{y.geometry.coordinates=y.geometry.coordinates.reverse()}),l.set(JSON.stringify(e),n),M(n)}})})}},x=e=>{var o=window.mapita._layers[e];o&&window.mapita.removeLayer(o)},Q=()=>{window.mapita.getZoom()>=15?p(window.mapita.getBounds()):r.forEach((e,o)=>{x(e),r.delete(o)})};var J=f.icon({iconUrl:re,iconSize:[15,39],iconAnchor:[7,39],popupAnchor:[0,-39]}),Z=f.icon({iconUrl:ne,iconSize:[25,55],iconAnchor:[12.5,55],popupAnchor:[0,-39]});t("#search").click(async()=>{L?C(t("#empresa").val(),t("#linea").val()):D||(C(t("#empresa").val(),t("#linea").val()),D=setTimeout(()=>{clearTimeout(D),D=null},2e3))});const C=(e,o)=>{t.ajax({url:`${T}/buses?codigoEmpresa=`+e+"&linea="+o,method:"get",contentType:"application/json",success:a=>{j(a),console.log(a)}})};function j(e){t("#search").html("Actualizar"),w=e.data,w.forEach(o=>{o.geometry.coordinates.reverse()}),e.lastUpdateDB,w.length>0?(O=new Array,w.forEach(o=>{O.indexOf(o.properties.destinoDesc)===-1&&O.push(o.properties.destinoDesc)}),L&&Y(),new Promise(function(o){q(),o()}),t("#alert_tiempo").empty(),Date.now()-e.lastUpdateDB>=2e4&&(t("#alert_tiempo").empty().append('<div class="alert alert-warning alert-dismissible fade show" role="alert">Las ubicaciones no están actualizadas, intente actualizar nuevamente en unos segundos. (diferencia '+(Date.now()-e.lastUpdateDB)/1e3+'segundos)<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button> </div>'),console.log("mas de 20 seg"),V(),t("#search").addClass("disabled"),t("#search").html("Espere"),setTimeout(function(){t("#search").removeClass("disabled"),t("#search").html("Actualizar")},5e3)),t(".tercero").removeAttr("hidden"),t("#select_company")[0].scrollIntoView()):t("#alert_tiempo").empty().append('<div class="alert alert-warning alert-dismissible fade show" role="alert">No hay ubicaciones reportadas para su búsqueda, intente nuevamente.<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button> </div>'),L=!1}function Y(){let e=0;t("#switch_destinations").empty(),O.forEach(o=>{e+=1,z(o,q,e)})}const z=(e,o,a)=>{t("#switch_destinations").append(`<div class= "form-check form-switch">
                <input class="form-check-input" type="checkbox" name="prueba" role="switch" value="${e}" id="flexSwitchCheck${a}" checked>
                <label class="form-check-label" for="flexSwitchCheck${e}">${e}</label>
            </div>`),t(`#flexSwitchCheck${a}`).click(()=>o())},q=()=>{var e=new Array;t(".form-check-input:checked").each(function(){e.push(t(this).val())});let o=w.filter(a=>e.includes(a.properties.destinoDesc));R(o,15)};function R(e,o){new Promise(function(a){window.mapita.removeLayer(v),v=f.featureGroup(),a()}).then(()=>{e.forEach(a=>{let d=null;S&&(d="disabled");const i=f.marker(a.geometry.coordinates,{icon:Z});i.bindPopup(`<div style="display: flex; justify-content: space-between;"> <p class="mb-0 mt-0 fs-6 fw-bold"><b>${a.properties.linea} </b> </p>       <button class= "mt-0 mb-0 btn btn-outline-primary btn-sm fw-bold seguiBus" ${d}>Seguí tu bondi</button> </div>
                </br>Destino: ${a.properties.destinoDesc} </br>
                 Tipo: ${a.properties.sublinea}`).on("click",_),ie.push(i),i.addTo(v),a.marker_id=v.getLayerId(i)}),v.addTo(window.mapita),U=null,U=v.getBounds(),e.length>1&&window.mapita.fitBounds(U),e.length==1&&window.mapita.setView(e[0].geometry.coordinates,o)})}t("#empresa").change(function(){L=!0;var e=t("#empresa").val();t(".segundo").removeAttr("disabled"),t("#linea").empty(),G[e].forEach(o=>{t("#linea").append("<option value="+o+">"+o+"</option>")})}),t("#linea").change(()=>{L=!0});const _=e=>{k=null,console.log(v.getLayerId(e.target)),k=w.filter(o=>o.marker_id==v.getLayerId(e.target)),e.target},H=e=>{e?(Date.now()-e.lastUpdateDB>=2e4&&V(),w=e.data,w.forEach(o=>{o.geometry.coordinates.reverse()}),R(w,window.mapita.getZoom())):(R(k,15),S=setInterval(()=>{$(k[0].properties.id)},7e3)),t("#alert_follow").empty().append('<div style="display: flex; justify-content: space-between;" class="alert alert-info fade show" role="alert"><p class="align-self-center mb-0 mt-0">Estás siguiendo a tu bondi (actualización automática).</p><button type="button" class="btn btn btn-outline-danger align-self-right" id="closeBtnFollow">Dejar de seguir</button> </div>'),t("#closeBtnFollow").click(()=>{t("#alert_follow").empty(),clearInterval(S),S=null,C(t("#empresa").val(),t("#linea").val())})};t(document).on("click",".seguiBus",function(e){S||H()});const $=e=>{t.ajax({url:`${T}/getBusbyID?ID=${e}`,method:"get",contentType:"application/json",success:o=>{H(o)}})};let P=[{codigo:"13",descripcion:"CASANOVA LIMITADA"},{codigo:"29",descripcion:"C.I.T.A."},{codigo:"10",descripcion:"C.O.E.T.C."},{codigo:"33",descripcion:"C.O. DEL ESTE"},{codigo:"20",descripcion:"C.O.M.E.S.A"},{codigo:"18",descripcion:"C.O.P.S.A."},{codigo:"50",descripcion:"C.U.T.C.S.A."},{codigo:"32",descripcion:"SATT"},{codigo:"35",descripcion:"TALA-PANDO-MONTEVIDEO"},{codigo:"70",descripcion:"U.C.O.T."},{codigo:"39",descripcion:"ZEBALLOS HERMANOS"}];for(let e in P)t("#empresa").append("<option value="+P[e].codigo+">"+P[e].descripcion+"</option>")});
